--14. For any two regions, Ô¨Ånd the gross discounted revenue (l extendedprice*(1-l discount)) derived from line items in which parts were shipped from a supplier in either region to a customer in the other region in 1995 and 1996. List the supplier region, the customer region, the year (l shipdate), and the revenue from shipments that took place in that year. Order the answers by supplier region, customer region, and year (all ascending).
select sr.r_name,cr.r_name,substr(l_shipdate,1,4),sum(l_extendedprice*(1-l_discount)) from lineitem,orders,customer,nation cn,region cr,supplier,nation sn,region sr where l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = cn.n_nationkey and cn.n_regionkey = cr.r_regionkey and l_suppkey = s_suppkey and s_nationkey = sn.n_nationkey and sn.n_regionkey = sr.r_regionkey and substr(l_shipdate,1,4) in ('1995','1996') group by sr.r_name,cr.r_name,substr(l_shipdate,1,4) order by sr.r_name,cr.r_name,substr(l_shipdate,1,4);
